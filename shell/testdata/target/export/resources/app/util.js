!function(){function e(e){return a.existsSync(e)}function n(i,t){try{if(e(i)){var r=a.statSync(i);if(r.isDirectory()){var c=a.readdirSync(i);c.forEach(function(e){var t=o.join(i,e);a.statSync(t).isDirectory()?n(t):a.unlinkSync(t)}),!t&&a.rmdirSync(i)}else a.unlinkSync(i)}return!0}catch(s){}}function i(n){try{var t=o.dirname(n);return e(t)||i(t),e(n)||a.mkdirSync(n),!0}catch(r){}}function t(e,n){n||(n={});var i=n.is_not_recursive;if(a.existsSync(e)){var r=a.statSync(e);if(r.isDirectory()){var c=[],s=a.readdirSync(e),u=n.mtime;return s.sort().forEach(function(n){var r=o.join(e,n),s=a.statSync(r),f=s.isDirectory(),y={name:r,isDir:f};u&&(y.mtime=s.mtime),f&&(y.sub=i?[]:t(r)),c.push(y)}),c}}}function r(e,n,i){var t=require("remote"),r=t.require("dialog");r[e](t.getCurrentWindow(),n,i)}var o=require("path"),a=require("fs"),c=require("util"),s=o.join(require("os").homedir(),"BPA","GT"),u=o.join(s,"config"),f=o.join(__dirname,"data"),y=o.join(f,"config"),l=o.join(f,"data"),d=o.join(f,"geo");Date.prototype.format=Date.prototype.format||function(e,n){e||(e="yyyy-MM-dd hh:mm:ss");var i={"M{2}":this.getMonth()+1,"d{2}":this.getDate(),"h{2}":this.getHours(),"m{2}":this.getMinutes(),"q{2}":Math.floor((this.getMonth()+3)/3)};n||(i["s{2}"]=this.getSeconds(),i["S{2}"]=this.getMilliseconds()),/(y{4}|y{2})/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var t in i)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[t]:("00"+i[t]).substr((""+i[t]).length)));return e};var h={},g=function(e){var n=e.name,i=require("path"),t=require("app"),r=(require("electron"),require("browser-window")),o=t.makeSingleInstance(function(){var e=r.getAllWindows();if(e&&e.length>0){var n=e[0];n.setAlwaysOnTop(!0),n.restore(),n.focus(),n.setAlwaysOnTop(!1)}return!0});return o?void t.quit():(t.on("window-all-closed",function(){t.quit()}),void t.on("ready",function(){var t=new r({width:e.width||1e3,height:e.height||1e3,show:!0,autoHideMenuBar:!0});t.loadURL(i.join("file://",__dirname,n+".html")),t.show();var o=t.webContents;o.on("dom-ready",function(){var e='require("./'+n+'")';o.executeJavaScript(e)})}))},p=function(e,n){if(a.existsSync(e)){a.existsSync(n)?a.unlinkSync(n):i(o.dirname(n));for(var t=65536,r=new Buffer(t),c=a.openSync(e,"r"),s=a.openSync(n,"w"),u=1,f=0;u>0;)u=a.readSync(c,r,0,t,f),a.writeSync(s,r,0,u),f+=u;a.closeSync(c),a.closeSync(s)}},m=function(e,n){function i(e){e&&0!=e.length&&e.forEach(function(e){e.isDir?i(e.sub):r[e.name]=1})}var r={};i(t(e));for(var o in r){var a=o,c=a.replace(e,n);p(a,c)}return!0};h.init=function(e,n){"renderer"==process.type?n&&n():g(e)},h.ui={},h.ui.checked=function(e,n){return c.isBoolean(n)?void e.prop("checked",n):e.prop("checked")},h.ui.dialog={alert:function(e,n){r("showMessageBox",{type:"info",buttons:["yes"],title:"\u7cfb\u7edf\u63d0\u793a",message:e,icon:null},n)},save:function(e,n){r("showSaveDialog",{title:"\u9009\u62e9\u4fdd\u5b58\u8def\u5f84",defaultPath:e,filters:[{name:"zip\u6587\u4ef6",extensions:["zip"]}]},function(e){e&&n&&n(e)})}},h.getProductTree=function(){try{return require(o.join(u,".sys/sys_product_tree"))}catch(e){}},h.getSys=function(){try{return require(o.join(u,".sys/sys"))}catch(e){}},h.file={},h.file.write=function(e,n){i(o.dirname(e)),a.writeFileSync(e,n)},h.file.exists=e,h.file.copy=p,h.file.rm=n,h.file.copyDir=m;var f=o.join(__dirname,"data"),y=o.join(f,"config"),l=o.join(f,"data"),d=o.join(f,"geo");h.CONST={PATH_CONFIG_USER:u,PATH_DATA:f,PATH_DATA_CONFIG:y,PATH_DATA_DATA:l,PATH_DATA_GEOFILE:d},module.exports=h}();